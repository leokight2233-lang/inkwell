<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Inkwell</title>
<link rel="manifest" href="manifest.json">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Inkwell">
<meta name="theme-color" content="#0e0c0a">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0e0c0a;--bg2:#161310;--bg3:#1e1a16;--bg4:#2a241e;
  --border:#3a3028;--text:#e8ddd0;--text2:#a89880;--text3:#6b5e50;
  --amber:#c8822a;--amber2:#e09840;--amber-glow:rgba(200,130,42,0.12);
  --red:#c05040;--green:#5a8060;
  --sw:248px; /* sidebar width */
  --cw:190px; /* chapter sidebar width */
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
body{font-family:'Crimson Text',serif;background:var(--bg);color:var(--text);height:100vh;overflow:hidden;font-size:17px;}
@keyframes fu{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

/* â”€â”€â”€ LIBRARY â”€â”€â”€ */
#library-screen{display:flex;flex-direction:column;height:100vh;overflow:hidden;}
.lib-header{padding:26px 26px 18px;border-bottom:1px solid var(--border);background:var(--bg2);display:flex;align-items:flex-end;justify-content:space-between;gap:12px;}
.lib-header h1{font-family:'Playfair Display',serif;font-size:26px;color:var(--amber2);}
.lib-header p{font-size:12px;color:var(--text3);font-family:'DM Mono',monospace;margin-top:2px;}
.lib-new-btn{background:var(--amber);color:#0e0c0a;border:none;padding:9px 18px;border-radius:8px;font-family:'DM Mono',monospace;font-size:12px;font-weight:500;cursor:pointer;letter-spacing:0.06em;transition:background 0.15s;white-space:nowrap;}
.lib-new-btn:hover{background:var(--amber2);}
.lib-body{flex:1;overflow-y:auto;padding:24px;}
.lib-body::-webkit-scrollbar{width:4px;}
.lib-body::-webkit-scrollbar-thumb{background:var(--border);}
.lib-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:16px;}
.story-card{background:var(--bg3);border:1px solid var(--border);border-radius:12px;overflow:hidden;cursor:pointer;transition:all 0.2s;animation:fu 0.2s ease;}
.story-card:hover{border-color:var(--amber);transform:translateY(-3px);box-shadow:0 10px 28px rgba(0,0,0,0.5);}
.story-cover{height:110px;display:flex;align-items:center;justify-content:center;font-size:50px;position:relative;overflow:hidden;}
.story-cover img{width:100%;height:100%;object-fit:cover;position:absolute;inset:0;}
.story-cover-icon{position:relative;z-index:1;}
.story-cover-upload{position:absolute;inset:0;background:rgba(0,0,0,0.52);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.15s;z-index:2;font-size:12px;color:#fff;font-family:'DM Mono',monospace;letter-spacing:0.04em;gap:10px;}
.story-card:hover .story-cover-upload{opacity:1;}
.cov-del-btn{background:rgba(192,80,64,0.85);border:none;color:#fff;border-radius:5px;padding:4px 8px;font-size:11px;font-family:'DM Mono',monospace;cursor:pointer;letter-spacing:0.03em;}
.story-info{padding:12px 14px 14px;}
.story-info h3{font-family:'Playfair Display',serif;font-size:15px;margin-bottom:3px;}
.story-info p{font-size:12px;color:var(--text3);}
.story-footer{display:flex;align-items:center;justify-content:space-between;margin-top:9px;}
.story-footer span{font-family:'DM Mono',monospace;font-size:10px;color:var(--text3);}
.story-del{background:none;border:none;color:var(--text3);cursor:pointer;font-size:15px;padding:2px 4px;transition:color 0.15s;}
.story-del:hover{color:var(--red);}
.story-accent{height:3px;}
.add-story-card{background:var(--bg3);border:2px dashed var(--border);border-radius:12px;min-height:188px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px;cursor:pointer;transition:all 0.15s;color:var(--text3);}
.add-story-card:hover{border-color:var(--amber);color:var(--amber);background:var(--amber-glow);}
.add-story-card .asc-plus{font-size:28px;}
.add-story-card span{font-size:12px;font-family:'DM Mono',monospace;letter-spacing:0.06em;}

/* â”€â”€â”€ APP SHELL â”€â”€â”€ */
#app-shell{display:none;height:100vh;position:relative;}
#app-shell.on{display:block;}

/* Hamburger â€” lives inside the topbar row, never overlaps title */
#hbg{
  background:none;border:1px solid var(--border);color:var(--text2);
  border-radius:7px;width:34px;height:34px;font-size:17px;
  display:none;align-items:center;justify-content:center;
  cursor:pointer;transition:all 0.15s;flex-shrink:0;
}
#app-shell.on #hbg{display:flex;}
#hbg:hover{border-color:var(--amber);color:var(--amber);}

/* Mobile overlay */
#sb-ov{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.55);z-index:59;}
#sb-ov.on{display:block;}

/* â”€â”€â”€ MAIN SIDEBAR â”€â”€â”€ */
#sidebar{
  position:fixed;top:0;left:0;bottom:0;width:var(--sw);
  background:var(--bg2);border-right:1px solid var(--border);
  display:flex;flex-direction:column;overflow:hidden;
  transition:transform 0.25s ease;z-index:60;
  transform:translateX(-100%);
}
#sidebar.open{transform:translateX(0);}
.sb-logo{padding:13px 16px;border-bottom:1px solid var(--border);display:flex;flex-direction:column;gap:2px;}
.sb-logo h2{font-family:'Playfair Display',serif;font-size:18px;color:var(--amber2);}
.sb-logo span{font-size:11px;color:var(--text3);font-family:'DM Mono',monospace;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.sb-back{display:flex;align-items:center;gap:7px;padding:10px 16px;border-bottom:1px solid var(--border);cursor:pointer;color:var(--text3);font-family:'DM Mono',monospace;font-size:12px;letter-spacing:0.05em;transition:color 0.15s;background:none;border-left:none;border-right:none;border-top:none;width:100%;text-align:left;}
.sb-back:hover{color:var(--amber);}
.nav-scroll{flex:1;overflow-y:auto;overflow-x:hidden;padding:6px 0 20px;}
.nav-scroll::-webkit-scrollbar{width:3px;}
.nav-scroll::-webkit-scrollbar-thumb{background:var(--border);}
.nlabel{font-family:'DM Mono',monospace;font-size:10px;color:var(--text3);letter-spacing:0.15em;text-transform:uppercase;padding:10px 16px 4px;}
.nitem{display:flex;align-items:center;gap:10px;padding:9px 16px;cursor:pointer;color:var(--text2);font-size:14px;transition:all 0.15s;border-left:2px solid transparent;}
.nitem:hover{background:var(--bg3);color:var(--text);}
.nitem.on{background:var(--amber-glow);color:var(--amber2);border-left-color:var(--amber);}
.nitem .ni{font-size:15px;width:20px;text-align:center;flex-shrink:0;}

/* â”€â”€â”€ WORKSPACE â”€â”€â”€ */
#ws{height:100vh;display:flex;flex-direction:column;overflow:hidden;}
.topbar{padding:10px 14px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;background:var(--bg2);gap:10px;flex-shrink:0;}
.topbar-l{display:flex;align-items:center;gap:10px;min-width:0;}
.topbar h2{font-family:'Playfair Display',serif;font-size:17px;}
.topbar .sub{font-size:11px;color:var(--text3);font-family:'DM Mono',monospace;margin-top:1px;}
.tbr{display:flex;gap:8px;align-items:center;}
#save-ind{font-family:'DM Mono',monospace;font-size:10px;color:var(--amber);opacity:0;transition:opacity 0.5s;letter-spacing:0.08em;}
.icon-btn{background:var(--bg3);border:1px solid var(--border);color:var(--text2);padding:6px 12px;border-radius:6px;cursor:pointer;font-family:'DM Mono',monospace;font-size:12px;transition:all 0.15s;}
.icon-btn:hover{border-color:var(--amber);color:var(--amber);}

/* â”€â”€â”€ PANELS â”€â”€â”€ */
#content{flex:1;overflow:hidden;display:flex;}
.panel{display:none;flex:1;flex-direction:column;overflow:hidden;}
.panel.on{display:flex;}
.pbody{flex:1;overflow-y:auto;padding:22px 24px;}
.pbody::-webkit-scrollbar{width:4px;}
.pbody::-webkit-scrollbar-thumb{background:var(--border);}

/* â”€â”€â”€ COMMON â”€â”€â”€ */
.stitle{font-family:'Playfair Display',serif;font-size:17px;color:var(--text2);margin-bottom:14px;padding-bottom:7px;border-bottom:1px solid var(--border);}
.add-btn{border:1px dashed var(--border);border-radius:7px;background:none;color:var(--text3);font-family:'Crimson Text',serif;font-size:14px;cursor:pointer;padding:8px 14px;transition:all 0.15s;text-align:center;}
.add-btn:hover{border-color:var(--amber);color:var(--amber);background:var(--amber-glow);}
.fl{font-family:'DM Mono',monospace;font-size:11px;letter-spacing:0.12em;text-transform:uppercase;color:var(--text3);margin-bottom:7px;}
.fi{width:100%;background:var(--bg3);border:1px solid var(--border);border-radius:6px;padding:9px 13px;color:var(--text);font-family:'Crimson Text',serif;font-size:16px;outline:none;resize:none;transition:border-color 0.15s;}
.fi:focus{border-color:var(--amber);}
.fg{margin-bottom:18px;}

/* â”€â”€â”€ MANUSCRIPT â”€â”€â”€ */
#ms-wrap{display:flex;flex:1;overflow:hidden;position:relative;}

/* Chapter sidebar */
#chsb{width:var(--cw);min-width:var(--cw);border-right:1px solid var(--border);background:var(--bg2);overflow-y:auto;flex-shrink:0;transition:width 0.22s,min-width 0.22s;}
#chsb.shut{width:0;min-width:0;overflow:hidden;border:none;}
/* Pull tab */
#ch-tab{
  position:absolute;top:50%;transform:translateY(-50%);
  width:16px;height:44px;
  background:var(--bg3);border:1px solid var(--border);
  border-left:none;border-radius:0 6px 6px 0;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;z-index:5;color:var(--text3);font-size:12px;
  left:var(--cw);transition:left 0.22s,color 0.15s;
  user-select:none;
}
#ch-tab:hover{color:var(--amber);background:var(--bg4);}
#chsb.shut~#ch-tab{left:0;}
#ch-tab .arr{transition:transform 0.22s;display:inline-block;}
#chsb.shut~#ch-tab .arr{transform:rotate(180deg);}

.chitem{padding:8px 13px;cursor:pointer;color:var(--text2);font-size:13px;transition:all 0.15s;border-left:2px solid transparent;}
.chitem:hover{background:var(--bg3);color:var(--text);}
.chitem.on{color:var(--amber2);border-left-color:var(--amber);background:var(--amber-glow);}
.chitem .chn{font-family:'DM Mono',monospace;font-size:10px;color:var(--text3);}

.ms-main{flex:1;display:flex;flex-direction:column;overflow:hidden;}
.ms-tb{padding:7px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:5px;flex-wrap:wrap;background:var(--bg2);flex-shrink:0;}
.ms-btn{background:none;border:1px solid var(--border);color:var(--text2);padding:4px 9px;border-radius:5px;cursor:pointer;font-size:13px;font-family:'DM Mono',monospace;transition:all 0.15s;}
.ms-btn:hover{border-color:var(--amber);color:var(--amber);}
.ms-div{width:1px;height:16px;background:var(--border);margin:0 2px;}
.ms-area{flex:1;overflow-y:auto;padding:36px 14%;}
.ms-area::-webkit-scrollbar{width:4px;}
.ms-area::-webkit-scrollbar-thumb{background:var(--border);}
.ch-title-in{font-family:'Playfair Display',serif;font-size:26px;color:var(--text);background:none;border:none;outline:none;width:100%;margin-bottom:18px;border-bottom:1px solid var(--border);padding-bottom:9px;}
.ch-title-in::placeholder{color:var(--text3);}
.ms-ed{min-height:60vh;outline:none;font-family:'Crimson Text',serif;font-size:18px;line-height:1.85;color:var(--text);caret-color:var(--amber2);}
.ms-ed:empty::before{content:"Begin your story hereâ€¦";color:var(--text3);pointer-events:none;}
.wc{font-family:'DM Mono',monospace;font-size:11px;color:var(--text3);padding:6px 18px;border-top:1px solid var(--border);text-align:right;}

/* â”€â”€â”€ CARDS â”€â”€â”€ */
.char-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:12px;}
.char-card{background:var(--bg3);border:1px solid var(--border);border-radius:10px;overflow:hidden;cursor:pointer;transition:all 0.2s;}
.char-card:hover{border-color:var(--amber);transform:translateY(-2px);}
.cport{height:115px;background:var(--bg4);display:flex;align-items:center;justify-content:center;position:relative;overflow:hidden;}
.cport img{width:100%;height:100%;object-fit:cover;}
.cpp{font-size:38px;opacity:0.2;}
.cov{position:absolute;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.15s;font-size:12px;color:var(--amber);font-family:'DM Mono',monospace;}
.char-card:hover .cov{opacity:1;}
.cbody{padding:9px 11px;}
.cbody h4{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:2px;}
.cbody p{font-size:12px;color:var(--text3);}
.cbar{height:3px;}
.add-card{background:var(--bg3);border:2px dashed var(--border);border-radius:10px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:7px;cursor:pointer;transition:all 0.15s;min-height:170px;color:var(--text3);}
.add-card:hover{border-color:var(--amber);color:var(--amber);background:var(--amber-glow);}
.add-card .plus{font-size:22px;}

.wiki-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(190px,1fr));gap:12px;}
.wcard{background:var(--bg3);border:1px solid var(--border);border-radius:10px;overflow:hidden;cursor:pointer;transition:all 0.2s;}
.wcard:hover{border-color:var(--amber);transform:translateY(-2px);}
.wct{height:3px;}
.wcb{padding:12px 13px;}
.wci{font-size:17px;margin-bottom:4px;opacity:0.6;}
.wcard h4{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:3px;}
.wcard p{font-size:12px;color:var(--text3);line-height:1.4;}

.maps-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(210px,1fr));gap:13px;}
.map-card{background:var(--bg3);border:1px solid var(--border);border-radius:10px;overflow:hidden;cursor:pointer;transition:all 0.2s;position:relative;}
.map-card:hover{border-color:var(--amber);transform:translateY(-2px);}
.map-del{position:absolute;top:6px;right:6px;background:rgba(0,0,0,0.7);border:none;color:#fff;border-radius:50%;width:28px;height:28px;font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:all 0.15s;z-index:5;}
.map-card:hover .map-del{opacity:1;}
.map-del:hover{background:var(--red);}
.miw{height:150px;background:var(--bg4);overflow:hidden;}
.miw img{width:100%;height:100%;object-fit:cover;}
.mph{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:36px;opacity:0.18;}
.mbody{padding:9px 12px;}
.mbody h4{font-family:'Playfair Display',serif;font-size:13px;}
.mbody p{font-size:11px;color:var(--text3);margin-top:2px;font-family:'DM Mono',monospace;}
.uzn{border:2px dashed var(--border);border-radius:10px;padding:28px 18px;text-align:center;cursor:pointer;transition:all 0.15s;margin-bottom:18px;}
.uzn:hover,.uzn.dov{border-color:var(--amber);background:var(--amber-glow);}
.uzn .uzi{font-size:30px;margin-bottom:7px;}
.uzn p{color:var(--text3);font-size:13px;}
.uzn strong{color:var(--amber);}

/* â”€â”€â”€ TIMELINE â”€â”€â”€ */
.tl-wrap{position:relative;padding:18px 0 18px 170px;}
.tl-line{position:absolute;left:170px;top:0;bottom:0;width:2px;background:var(--border);}
.tl-ev{display:flex;margin-bottom:24px;position:relative;align-items:flex-start;}
.tl-dc{position:absolute;right:calc(100% + 12px);text-align:right;width:150px;}
.tl-date{font-family:'DM Mono',monospace;font-size:11px;color:var(--amber);}
.tl-era{font-size:11px;color:var(--text3);margin-top:1px;}
.tl-dot{width:12px;height:12px;border-radius:50%;background:var(--amber);flex-shrink:0;margin-top:4px;position:absolute;left:-6px;border:2px solid var(--bg2);z-index:1;}
.tl-dot.minor{background:var(--border);}
.tl-cnt{margin-left:20px;flex:1;background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px 13px;}
.tl-cnt h4{font-family:'Playfair Display',serif;font-size:13px;margin-bottom:2px;}
.tl-cnt p{font-size:13px;color:var(--text2);line-height:1.5;}

/* â”€â”€â”€ ENTITY DETAIL â”€â”€â”€ */
.edet{flex:1;overflow-y:auto;padding:22px 24px;}
.edet::-webkit-scrollbar{width:4px;}
.edet::-webkit-scrollbar-thumb{background:var(--border);}
.imu{border:2px dashed var(--border);border-radius:10px;padding:16px;text-align:center;cursor:pointer;transition:all 0.15s;margin-bottom:15px;overflow:hidden;position:relative;}
.imu img{max-width:100%;max-height:190px;border-radius:6px;display:block;margin:0 auto;}
.imu.has{border-color:var(--border);padding:4px;}
.imu:not(.has):hover{border-color:var(--amber);background:var(--amber-glow);}
.imu p{color:var(--text3);font-size:13px;margin-top:5px;}
.img-del{position:absolute;top:6px;right:6px;background:rgba(0,0,0,0.7);border:none;color:#fff;border-radius:50%;width:26px;height:26px;font-size:13px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background 0.15s;z-index:3;}
.img-del:hover{background:var(--red);}

/* â”€â”€â”€ LIGHTBOX â”€â”€â”€ */
.lb{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.93);z-index:200;align-items:center;justify-content:center;flex-direction:column;}
.lb.on{display:flex;}
.lb img{max-width:92vw;max-height:84vh;border-radius:8px;object-fit:contain;}
.lb-x{position:absolute;top:14px;right:16px;background:none;border:none;color:var(--text);font-size:28px;cursor:pointer;}
.lb-cap{color:var(--text2);font-size:12px;margin-top:9px;font-family:'DM Mono',monospace;}

/* â”€â”€â”€ MODAL â”€â”€â”€ */
.mov{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.75);z-index:100;align-items:center;justify-content:center;}
.mov.on{display:flex;}
.modal{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:22px;width:410px;max-width:93vw;animation:fu 0.2s ease;max-height:90vh;overflow-y:auto;}
.modal h3{font-family:'Playfair Display',serif;font-size:18px;margin-bottom:14px;color:var(--amber2);}
.mbtns{display:flex;gap:8px;margin-top:16px;justify-content:flex-end;}
.btn-g{background:none;border:1px solid var(--border);color:var(--text2);padding:7px 15px;border-radius:6px;font-family:'Crimson Text',serif;font-size:15px;cursor:pointer;transition:all 0.15s;}
.btn-g:hover{border-color:var(--text2);color:var(--text);}
.btn-p{background:var(--amber);border:none;color:#0e0c0a;padding:7px 15px;border-radius:6px;font-family:'DM Mono',monospace;font-size:12px;font-weight:500;cursor:pointer;letter-spacing:0.05em;transition:background 0.15s;}
.btn-p:hover{background:var(--amber2);}
.crow{display:flex;gap:8px;margin-bottom:13px;flex-wrap:wrap;}
.co{width:22px;height:22px;border-radius:50%;cursor:pointer;border:2px solid transparent;transition:border-color 0.15s;}
.co.sel{border-color:var(--text);}

/* â”€â”€â”€ RESPONSIVE â”€â”€â”€ */
@media(max-width:640px){
  .ms-area{padding:22px 4%!important;}
  .pbody{padding:14px!important;}
  .edet{padding:14px!important;}
  .lib-body{padding:14px!important;}
  .lib-grid{grid-template-columns:repeat(auto-fill,minmax(145px,1fr));}
  .topbar h2{font-size:15px;}
}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â• LIBRARY â•â•â•â•â•â•â•â• -->
<div id="library-screen">
  <div class="lib-header">
    <div>
      <h1>âœ¦ Inkwell</h1>
      <p>your story library</p>
    </div>
    <button class="lib-new-btn" onclick="openNewStoryModal()">+ New Story</button>
  </div>
  <div class="lib-body">
    <div class="lib-grid" id="lib-grid"></div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â• APP SHELL â•â•â•â•â•â•â•â• -->
<div id="app-shell">
  <div id="sb-ov" onclick="closeSB()"></div>

  <!-- SIDEBAR -->
  <div id="sidebar">
    <div class="sb-logo">
      <h2>âœ¦ Inkwell</h2>
      <span id="sb-title">My Story</span>
    </div>
    <button class="sb-back" onclick="goLibrary()">â† Back to Library</button>
    <div class="nav-scroll">
      <div class="nlabel">Story</div>
      <div class="nitem" onclick="nav('manuscript');autoCloseSB();" id="n-manuscript"><span class="ni">âœ</span> Manuscript</div>
      <div class="nitem" onclick="nav('outline');autoCloseSB();" id="n-outline"><span class="ni">â‰¡</span> Outline</div>
      <div class="nitem" onclick="nav('timeline');autoCloseSB();" id="n-timeline"><span class="ni">â±</span> Timeline</div>
      <div class="nlabel">World</div>
      <div class="nitem" onclick="nav('characters');autoCloseSB();" id="n-characters"><span class="ni">â—‰</span> Characters</div>
      <div class="nitem" onclick="nav('locations');autoCloseSB();" id="n-locations"><span class="ni">âŒ–</span> Locations</div>
      <div class="nitem" onclick="nav('maps');autoCloseSB();" id="n-maps"><span class="ni">â¬¡</span> Maps</div>
      <div class="nitem" onclick="nav('species');autoCloseSB();" id="n-species"><span class="ni">âœº</span> Species</div>
      <div class="nitem" onclick="nav('culture');autoCloseSB();" id="n-culture"><span class="ni">âš˜</span> Culture</div>
      <div class="nlabel">Lore</div>
      <div class="nitem" onclick="nav('magic');autoCloseSB();" id="n-magic"><span class="ni">â—ˆ</span> Magic</div>
      <div class="nitem" onclick="nav('religion');autoCloseSB();" id="n-religion"><span class="ni">âœ¦</span> Religion</div>
      <div class="nitem" onclick="nav('items');autoCloseSB();" id="n-items"><span class="ni">â—‡</span> Items</div>
      <div class="nitem" onclick="nav('encyclopedia');autoCloseSB();" id="n-encyclopedia"><span class="ni">ğŸ“–</span> Encyclopedia</div>
      <div class="nlabel">Tools</div>
      <div class="nitem" onclick="nav('research');autoCloseSB();" id="n-research"><span class="ni">ğŸ”¬</span> Research</div>
    </div>
  </div>

  <!-- WORKSPACE -->
  <div id="ws">
    <div class="topbar">
      <div class="topbar-l">
        <button id="hbg" onclick="toggleSB()" title="Menu">â˜°</button>
        <div>
          <h2 id="tt">Manuscript</h2>
          <div class="sub" id="ts">Write your story</div>
        </div>
      </div>
      <div class="tbr">
        <span id="save-ind">âœ¦ saved</span>
        <button class="icon-btn" id="add-btn" style="display:none" onclick="topAdd()">+ Add</button>
      </div>
    </div>

    <div id="content">

      <!-- MANUSCRIPT -->
      <div class="panel" id="p-manuscript">
        <div id="ms-wrap">
          <div id="chsb">
            <div style="padding:8px 10px 4px;">
              <button class="add-btn" style="width:100%;font-size:12px;padding:6px;" onclick="addCh()">+ Chapter</button>
            </div>
            <div id="ch-list"></div>
          </div>
          <div id="ch-tab" onclick="toggleChSB()"><span class="arr">â€¹</span></div>
          <div class="ms-main">
            <div class="ms-tb">
              <button class="ms-btn" onclick="ec('bold')"><b>B</b></button>
              <button class="ms-btn" onclick="ec('italic')"><i>I</i></button>
              <button class="ms-btn" onclick="ec('underline')"><u>U</u></button>
              <div class="ms-div"></div>
              <button class="ms-btn" onclick="insBreak()">â€” Break</button>
              <div class="ms-div"></div>
              <button class="ms-btn" id="focus-btn" onclick="focusMode()">Focus</button>
            </div>
            <div class="ms-area" id="ms-area">
              <input class="ch-title-in" id="ch-title" placeholder="Chapter Titleâ€¦" oninput="updChTitle(this.value)">
              <div class="ms-ed" id="ms-ed" contenteditable="true" oninput="onEdit()" onkeydown="edKey(event)"></div>
            </div>
            <div class="wc" id="wc">0 words</div>
          </div>
        </div>
      </div>

      <!-- OUTLINE -->
      <div class="panel" id="p-outline"><div class="pbody" id="outline-body"></div></div>

      <!-- TIMELINE -->
      <div class="panel" id="p-timeline">
        <div class="pbody">
          <div class="stitle">Story Timeline</div>
          <div style="position:relative;overflow:visible;"><div class="tl-wrap" id="tl-wrap"></div></div>
          <div style="padding-left:188px;margin-top:6px;"><button class="add-btn" onclick="addTLEv()">+ Add Event</button></div>
        </div>
      </div>

      <!-- CHARACTERS -->
      <div class="panel" id="p-characters"><div class="pbody"><div class="stitle">Characters</div><div class="char-grid" id="char-grid"></div></div></div>
      <div class="panel" id="p-char-detail"><div class="edet" id="char-det"></div></div>

      <!-- LOCATIONS -->
      <div class="panel" id="p-locations"><div class="pbody"><div class="stitle">Locations</div><div class="wiki-grid" id="locations-grid"></div></div></div>
      <div class="panel" id="p-loc-detail"><div class="edet" id="loc-det"></div></div>

      <!-- MAPS -->
      <div class="panel" id="p-maps">
        <div class="pbody">
          <div class="stitle">Maps &amp; Images</div>
          <label class="uzn" id="dz">
            <input type="file" accept="image/*" multiple style="display:none" onchange="handleUp(this.files)">
            <div class="uzi">ğŸ—º</div>
            <p><strong>Tap to upload</strong> or drag &amp; drop</p>
            <p style="margin-top:3px;font-size:12px;">PNG, JPG, WebP, GIF</p>
          </label>
          <div class="maps-grid" id="maps-grid"></div>
        </div>
      </div>

      <!-- WIKI -->
      <div class="panel" id="p-species"><div class="pbody"><div class="stitle">Species &amp; Races</div><div class="wiki-grid" id="species-grid"></div></div></div>
      <div class="panel" id="p-culture"><div class="pbody"><div class="stitle">Cultures &amp; Factions</div><div class="wiki-grid" id="culture-grid"></div></div></div>
      <div class="panel" id="p-magic"><div class="pbody"><div class="stitle">Magic Systems</div><div class="wiki-grid" id="magic-grid"></div></div></div>
      <div class="panel" id="p-religion"><div class="pbody"><div class="stitle">Religions &amp; Pantheons</div><div class="wiki-grid" id="religion-grid"></div></div></div>
      <div class="panel" id="p-items"><div class="pbody"><div class="stitle">Items &amp; Artifacts</div><div class="wiki-grid" id="items-grid"></div></div></div>
      <div class="panel" id="p-encyclopedia"><div class="pbody"><div class="stitle">Encyclopedia</div><div class="wiki-grid" id="encyclopedia-grid"></div></div></div>
      <div class="panel" id="p-research"><div class="pbody"><div class="stitle">Research &amp; Notes</div><div class="wiki-grid" id="research-grid"></div></div></div>
      <div class="panel" id="p-wiki-detail"><div class="edet" id="wiki-det"></div></div>

    </div><!-- /content -->
  </div><!-- /ws -->
</div><!-- /app-shell -->

<!-- LIGHTBOX -->
<div class="lb" id="lb" onclick="closeLB()">
  <button class="lb-x" onclick="closeLB()">Ã—</button>
  <img id="lb-img" src="" alt="">
  <div class="lb-cap" id="lb-cap"></div>
</div>

<!-- MODAL -->
<div class="mov" id="modal" onclick="if(event.target===this)closeModal()">
  <div class="modal">
    <h3 id="modal-title"></h3>
    <div id="modal-body"></div>
    <div class="mbtns">
      <button class="btn-g" onclick="closeModal()">Cancel</button>
      <button class="btn-p" onclick="modalOK()">Create</button>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STORAGE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const LIB_KEY  = 'inkwell_lib_v3';
const ST_KEY   = id => 'inkwell_st_' + id;
const PAL = ['#c8822a','#c05040','#5a8060','#5060a0','#806080','#607080','#a0803a','#609060'];
const COVERS = ['ğŸ“–','âš”ï¸','ğŸŒ‘','ğŸ°','ğŸŒ¿','ğŸ”®','ğŸ—ºï¸','ğŸ‘ï¸','ğŸ‰','ğŸŒŠ'];

function loadLib(){ try{const r=localStorage.getItem(LIB_KEY);return r?JSON.parse(r):[];}catch{return [];}}
function saveLib(){ try{localStorage.setItem(LIB_KEY,JSON.stringify(LIB));}catch(e){}}
function loadST(id){ try{const r=localStorage.getItem(ST_KEY(id));return r?JSON.parse(r):null;}catch{return null;}}
function saveST(){
  if(!CID)return;
  try{
    localStorage.setItem(ST_KEY(CID),JSON.stringify({
      characters:S.chars,locations:S.locs,maps:S.maps,
      species:S.species,culture:S.culture,magic:S.magic,
      religion:S.religion,items:S.items,encyclopedia:S.enc,research:S.res,
      chapters:S.chs,outline:S.outline,timeline:S.tl,
    }));
    showSave();
  }catch(e){console.warn('Save fail',e);}
}
let _st=null;
function sched(){ clearTimeout(_st);_st=setTimeout(saveST,700);}
function showSave(){const e=document.getElementById('save-ind');if(!e)return;e.style.opacity='1';setTimeout(()=>e.style.opacity='0',1500);}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIBRARY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let LIB = loadLib();
let CID = null; // current story id

function renderLib(){
  document.getElementById('lib-grid').innerHTML = LIB.map(s=>`
    <div class="story-card" onclick="openStory('${s.id}')">
      <div class="story-cover" style="background:${s.color}18;">
        ${s.coverImg?`<img src="${s.coverImg}" alt="">`:''}
        <div class="story-cover-icon">${s.coverImg?'':s.icon||'ğŸ“–'}</div>
        <div class="story-cover-upload">
          <span onclick="event.stopPropagation();trigCoverUpload('${s.id}')" style="cursor:pointer;">ğŸ“· Photo</span>
          ${s.coverImg?`<button class="cov-del-btn" onclick="event.stopPropagation();delCoverImg('${s.id}')">âœ• Remove</button>`:''}
        </div>
        <input type="file" id="cov-${s.id}" accept="image/*" style="display:none" onchange="loadCoverImg('${s.id}',this)">
      </div>
      <div class="story-info">
        <h3>${esc(s.title)}</h3>
        <p>${esc(s.genre||'Novel')}</p>
        <div class="story-footer">
          <span>${s.mod||s.created||''}</span>
          <button class="story-del" onclick="event.stopPropagation();delStory('${s.id}')" title="Delete story">ğŸ—‘</button>
        </div>
      </div>
      <div class="story-accent" style="background:${s.color};"></div>
    </div>
  `).join('') + `
    <div class="add-story-card" onclick="openNewStoryModal()">
      <div class="asc-plus">+</div><span>New Story</span>
    </div>`;
}

function openNewStoryModal(){
  const dc=PAL[Math.floor(Math.random()*PAL.length)];
  const di=COVERS[Math.floor(Math.random()*COVERS.length)];
  MS.color=dc; MS.icon=di;
  openModal('New Story',`
    <div class="fg"><div class="fl">Title</div><input class="fi" id="m-t" placeholder="Story titleâ€¦"></div>
    <div class="fg"><div class="fl">Genre / Type</div><input class="fi" id="m-g" placeholder="Fantasy, Sci-Fi, Romanceâ€¦"></div>
    <div class="fl">Color</div>
    <div class="crow">${PAL.map((c,i)=>`<div class="co ${c===dc?'sel':''}" style="background:${c}" onclick="selCol(this,'${c}')"></div>`).join('')}</div>
    <div class="fl">Icon</div>
    <div style="display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px;" id="icon-row">
      ${COVERS.map(ic=>`<div onclick="selIcon(this,'${ic}')" style="font-size:22px;cursor:pointer;padding:4px 6px;border-radius:6px;border:2px solid ${ic===di?'var(--amber)':'transparent'};transition:border-color 0.15s;">${ic}</div>`).join('')}
    </div>
  `,()=>{
    const t=document.getElementById('m-t').value.trim();
    if(!t)return;
    const id='st_'+Date.now();
    const s={id,title:t,genre:document.getElementById('m-g').value,color:MS.color||dc,icon:MS.icon||di,created:today(),mod:today()};
    LIB.push(s);saveLib();renderLib();openStory(id);
  });
}

function selIcon(el,ic){
  document.querySelectorAll('#icon-row div').forEach(d=>d.style.borderColor='transparent');
  el.style.borderColor='var(--amber)';MS.icon=ic;
}
function trigCoverUpload(id){document.getElementById('cov-'+id).click();}
function loadCoverImg(id,inp){
  const f=inp.files[0];if(!f)return;
  const r=new FileReader();
  r.onload=e=>{
    const s=LIB.find(x=>x.id===id);
    if(s){s.coverImg=e.target.result;saveLib();renderLib();}
  };r.readAsDataURL(f);
}
function delCoverImg(id){
  const s=LIB.find(x=>x.id===id);
  if(s){delete s.coverImg;saveLib();renderLib();}
}
function delStory(id){
  if(!confirm('Delete this story? This cannot be undone.'))return;
  LIB=LIB.filter(s=>s.id!==id);saveLib();
  try{localStorage.removeItem(ST_KEY(id));}catch(e){}
  renderLib();
}
function today(){return new Date().toLocaleDateString();}

function openStory(id){
  CID=id;
  const meta=LIB.find(s=>s.id===id);
  if(!meta)return;
  meta.mod=today();saveLib();
  const d=loadST(id)||blankStory();
  S.chars=d.characters;S.locs=d.locations;S.maps=d.maps;
  S.species=d.species;S.culture=d.culture;S.magic=d.magic;
  S.religion=d.religion;S.items=d.items;S.enc=d.encyclopedia;S.res=d.research;
  S.chs=d.chapters;S.outline=d.outline;S.tl=d.timeline;
  document.getElementById('sb-title').textContent=meta.title;
  document.getElementById('library-screen').style.display='none';
  document.getElementById('app-shell').classList.add('on');
  nav('manuscript');
  loadCh(S.chs[0]?.id||'ch0');
}
function goLibrary(){
  saveST();CID=null;
  document.getElementById('app-shell').classList.remove('on');
  document.getElementById('library-screen').style.display='flex';
  closeSB();renderLib();
}
function blankStory(){
  return{
    characters:[],locations:[],maps:[],species:[],culture:[],magic:[],religion:[],items:[],encyclopedia:[],research:[],
    chapters:[{id:'ch0',title:'Chapter One',content:'',wc:0}],
    outline:{acts:[
      {id:'a1',label:'ACT I',title:'Setup',scenes:[{id:'s1',title:'Opening Scene',notes:'Introduce the world and protagonist',status:'todo'},{id:'s2',title:'Inciting Incident',notes:'The event that changes everything',status:'todo'}]},
      {id:'a2',label:'ACT II',title:'Confrontation',scenes:[{id:'s3',title:'Rising Action',notes:'Complications mount',status:'todo'}]},
      {id:'a3',label:'ACT III',title:'Resolution',scenes:[{id:'s4',title:'Climax',notes:'The final confrontation',status:'todo'}]}
    ]},
    timeline:[],
  };
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// APP STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const S={
  sbOpen:false,chOpen:true,curPanel:'manuscript',curCh:'ch0',
  chars:[],locs:[],maps:[],species:[],culture:[],magic:[],religion:[],items:[],enc:[],res:[],
  chs:[],outline:{acts:[]},tl:[]
};
const MS={color:'#c8822a',icon:'ğŸ“–'}; // modal scratch

const SC={done:'#5a8060','in-progress':'#c8822a',todo:'#3a3028'};
const META={
  manuscript:{t:'Manuscript',s:'Write your story'},outline:{t:'Outline',s:'Organize your narrative'},
  timeline:{t:'Timeline',s:'Key events in your world'},characters:{t:'Characters',s:'The people of your story'},
  locations:{t:'Locations',s:'Places in your world'},maps:{t:'Maps & Images',s:'Visual references'},
  species:{t:'Species',s:'The beings of your world'},culture:{t:'Culture',s:'Groups and customs'},
  magic:{t:'Magic',s:'The rules of your magic'},religion:{t:'Religion',s:'Gods and beliefs'},
  items:{t:'Items',s:'Objects of significance'},encyclopedia:{t:'Encyclopedia',s:'World knowledge'},
  research:{t:'Research',s:'Notes and references'},
};
const WCOL={species:'#5a8060',culture:'#5060a0',magic:'#806080',religion:'#c8822a',items:'#a0803a',encyclopedia:'#607080',research:'#609060',locations:'#c05040'};
const WICO={species:'âœº',culture:'âš˜',magic:'â—ˆ',religion:'âœ¦',items:'â—‡',encyclopedia:'ğŸ“–',research:'ğŸ”¬',locations:'âŒ–'};
const WFLDS={
  species:[['description','Description',true],['habitat','Habitat',false],['abilities','Abilities',true],['culture','Culture',true],['notes','Notes',true]],
  culture:[['overview','Overview',true],['beliefs','Beliefs',true],['customs','Customs',true],['history','History',true],['notes','Notes',true]],
  magic:[['overview','Overview',true],['source','Source',false],['rules','Rules',true],['cost','Cost / Drawbacks',true],['notes','Notes',true]],
  religion:[['overview','Overview',true],['deity','Deity',false],['beliefs','Core Beliefs',true],['rituals','Rituals',true],['notes','Notes',true]],
  items:[['description','Description',true],['origin','Origin',true],['powers','Powers',true],['history','History',true],['notes','Notes',true]],
  encyclopedia:[['overview','Overview',true],['details','Details',true],['significance','Significance',true],['notes','Notes',true]],
  research:[['source','Source',false],['notes','Notes',true],['quotes','Key Quotes',true],['relevance','Relevance',true]],
  locations:[['geography','Geography',true],['atmosphere','Atmosphere',true],['history','History',true],['inhabitants','Inhabitants',false],['notes','Notes',true]],
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIDEBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleSB(){S.sbOpen?closeSB():openSB();}
function openSB(){
  S.sbOpen=true;
  document.getElementById('sidebar').classList.add('open');
  if(window.innerWidth<=640) document.getElementById('sb-ov').classList.add('on');
}
function closeSB(){
  S.sbOpen=false;
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('sb-ov').classList.remove('on');
}
function autoCloseSB(){if(window.innerWidth<=640)closeSB();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHAPTER SIDEBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function toggleChSB(){
  S.chOpen=!S.chOpen;
  document.getElementById('chsb').classList.toggle('shut',!S.chOpen);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function nav(pg,id){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('on'));
  document.querySelectorAll('.nitem').forEach(n=>n.classList.remove('on'));
  S.curPanel=pg;
  const m=META[pg];
  if(m){document.getElementById('tt').textContent=m.t;document.getElementById('ts').textContent=m.s;}
  const ni=document.getElementById('n-'+pg);if(ni)ni.classList.add('on');
  const ab=document.getElementById('add-btn');ab.style.display='none';
  const wiki=['species','culture','magic','religion','items','encyclopedia','research'];
  if(pg==='manuscript'){show('p-manuscript');renderChList();}
  else if(pg==='outline'){show('p-outline');renderOutline();}
  else if(pg==='timeline'){show('p-timeline');renderTL();}
  else if(pg==='characters'){show('p-characters');renderCharGrid();ab.style.display='inline-block';ab.onclick=openCharModal;}
  else if(pg==='char-detail'){show('p-char-detail');document.getElementById('n-characters').classList.add('on');renderCharDet(id);}
  else if(pg==='locations'){show('p-locations');renderWG('locations','locations-grid');ab.style.display='inline-block';ab.onclick=()=>openWM('locations');}
  else if(pg==='loc-detail'){show('p-loc-detail');document.getElementById('n-locations').classList.add('on');renderLocDet(id);}
  else if(pg==='maps'){show('p-maps');renderMaps();}
  else if(pg==='wiki-detail'){show('p-wiki-detail');const sec=id.split(':')[0];const n2=document.getElementById('n-'+sec);if(n2)n2.classList.add('on');renderWD(id);}
  else if(wiki.includes(pg)){show('p-'+pg);renderWG(pg,pg+'-grid');ab.style.display='inline-block';ab.onclick=()=>openWM(pg);}
}
function show(id){document.getElementById(id).classList.add('on');}
function topAdd(){document.getElementById('add-btn').onclick();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MANUSCRIPT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderChList(){
  document.getElementById('ch-list').innerHTML=S.chs.map((c,i)=>`
    <div class="chitem ${c.id===S.curCh?'on':''}" onclick="loadCh('${c.id}')">
      <div class="chn">CH ${i+1}</div>
      <div>${esc(c.title||'Untitled')}</div>
    </div>
  `).join('');
}
function loadCh(id){
  S.curCh=id;const c=S.chs.find(x=>x.id===id);if(!c)return;
  document.getElementById('ch-title').value=c.title||'';
  document.getElementById('ms-ed').innerHTML=c.content||'';
  updWC();renderChList();
}
function addCh(){
  const id='ch'+Date.now();S.chs.push({id,title:'New Chapter',content:'',wc:0});
  S.curCh=id;renderChList();loadCh(id);sched();
}
function updChTitle(v){const c=S.chs.find(x=>x.id===S.curCh);if(c){c.title=v;renderChList();sched();}}
function onEdit(){const c=S.chs.find(x=>x.id===S.curCh);if(c)c.content=document.getElementById('ms-ed').innerHTML;updWC();sched();}
function updWC(){const t=document.getElementById('ms-ed').innerText||'';const n=t.trim()?t.trim().split(/\s+/).length:0;document.getElementById('wc').textContent=n.toLocaleString()+' words';}
function ec(cmd){document.execCommand(cmd,false,null);document.getElementById('ms-ed').focus();}
function insBreak(){document.execCommand('insertHTML',false,'<div style="text-align:center;color:#6b5e50;margin:20px 0;letter-spacing:0.4em;">âœ¦ âœ¦ âœ¦</div>');}
function edKey(e){if(e.key==='Tab'){e.preventDefault();document.execCommand('insertText',false,'    ');}}
let fOn=false;
function focusMode(){
  fOn=!fOn;
  document.getElementById('chsb').style.display=fOn?'none':'';
  document.getElementById('ch-tab').style.display=fOn?'none':'';
  document.querySelector('.ms-tb').style.display=fOn?'none':'';
  document.getElementById('ms-area').style.padding=fOn?'36px 18%':'36px 14%';
  document.getElementById('focus-btn').textContent=fOn?'Exit':'Focus';
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// OUTLINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderOutline(){
  document.getElementById('outline-body').innerHTML=S.outline.acts.map(a=>`
    <div style="margin-bottom:24px;">
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:9px;">
        <div style="font-family:'DM Mono',monospace;font-size:10px;letter-spacing:0.15em;color:var(--amber);background:var(--amber-glow);border:1px solid var(--amber);border-radius:4px;padding:2px 9px;">${a.label}</div>
        <input style="background:none;border:none;font-family:'Playfair Display',serif;font-size:16px;color:var(--text);outline:none;flex:1;" value="${esc(a.title)}" oninput="updAct('${a.id}',this.value)" placeholder="Act titleâ€¦">
      </div>
      ${a.scenes.map((s,si)=>`
        <div style="background:var(--bg3);border:1px solid var(--border);border-radius:8px;padding:10px 13px;margin-bottom:6px;display:flex;align-items:flex-start;gap:9px;">
          <div style="font-family:'DM Mono',monospace;font-size:10px;color:var(--text3);min-width:16px;padding-top:2px;">${si+1}</div>
          <div style="flex:1;">
            <input style="background:none;border:none;font-family:'Playfair Display',serif;font-size:14px;color:var(--text);outline:none;width:100%;margin-bottom:3px;" value="${esc(s.title)}" oninput="updSc('${a.id}','${s.id}','title',this.value)" placeholder="Scene titleâ€¦">
            <textarea style="background:none;border:none;font-family:'Crimson Text',serif;font-size:13px;color:var(--text3);outline:none;width:100%;resize:none;line-height:1.4;" rows="1" oninput="updSc('${a.id}','${s.id}','notes',this.value)" placeholder="Notesâ€¦">${esc(s.notes)}</textarea>
          </div>
          <div style="width:10px;height:10px;border-radius:50%;background:${SC[s.status]};margin-top:4px;flex-shrink:0;cursor:pointer;" onclick="cycSt('${a.id}','${s.id}',this)" title="${s.status}"></div>
        </div>
      `).join('')}
      <button class="add-btn" style="width:100%;margin-top:2px;" onclick="addSc('${a.id}')">+ Scene</button>
    </div>
  `).join('')+`<button class="add-btn" onclick="addAct()">+ Add Act</button>`;
}
function updAct(id,v){const a=S.outline.acts.find(x=>x.id===id);if(a){a.title=v;sched();}}
function updSc(ai,si,k,v){const a=S.outline.acts.find(x=>x.id===ai);if(a){const s=a.scenes.find(x=>x.id===si);if(s){s[k]=v;sched();}}}
function cycSt(ai,si,el){const a=S.outline.acts.find(x=>x.id===ai);const s=a.scenes.find(x=>x.id===si);const st=['todo','in-progress','done'];s.status=st[(st.indexOf(s.status)+1)%3];el.style.background=SC[s.status];el.title=s.status;sched();}
function addSc(ai){const a=S.outline.acts.find(x=>x.id===ai);a.scenes.push({id:'s'+Date.now(),title:'New Scene',notes:'',status:'todo'});renderOutline();sched();}
function addAct(){const L=['ACT I','ACT II','ACT III','ACT IV','ACT V'];S.outline.acts.push({id:'a'+Date.now(),label:L[S.outline.acts.length]||'ACT '+(S.outline.acts.length+1),title:'New Act',scenes:[]});renderOutline();sched();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TIMELINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderTL(){
  document.getElementById('tl-wrap').innerHTML='<div class="tl-line"></div>'+S.tl.map(e=>`
    <div class="tl-ev">
      <div class="tl-dc"><div class="tl-date">${esc(e.date)}</div><div class="tl-era">${esc(e.era)}</div></div>
      <div class="tl-dot ${e.major?'':'minor'}"></div>
      <div class="tl-cnt"><h4>${esc(e.title)}</h4><p>${esc(e.desc)}</p></div>
    </div>
  `).join('');
}
function addTLEv(){
  openModal('Add Timeline Event',`
    <div class="fg"><div class="fl">Date / Year</div><input class="fi" id="m-dt" placeholder="Year 400â€¦"></div>
    <div class="fg"><div class="fl">Era / Age</div><input class="fi" id="m-er" placeholder="The Ancient Ageâ€¦"></div>
    <div class="fg"><div class="fl">Event Title</div><input class="fi" id="m-et" placeholder="Nameâ€¦"></div>
    <div class="fg"><div class="fl">Description</div><textarea class="fi" id="m-ed" rows="3" placeholder="What happened?"></textarea></div>
    <div style="display:flex;align-items:center;gap:8px;"><input type="checkbox" id="m-maj" checked style="accent-color:var(--amber)"><label for="m-maj" style="font-size:14px;color:var(--text2);">Major event</label></div>
  `,()=>{
    S.tl.push({id:'t'+Date.now(),date:document.getElementById('m-dt').value||'Unknown',era:document.getElementById('m-er').value||'',title:document.getElementById('m-et').value||'Unnamed',desc:document.getElementById('m-ed').value||'',major:document.getElementById('m-maj').checked});
    renderTL();sched();
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHARACTERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCharGrid(){
  document.getElementById('char-grid').innerHTML=S.chars.map(c=>`
    <div class="char-card" onclick="nav('char-detail','${c.id}')">
      <div class="cbar" style="background:${c.color}"></div>
      <div class="cport">${c.image?`<img src="${c.image}" alt="${esc(c.name)}">`:`<div class="cpp">â—‰</div>`}<div class="cov">Open</div></div>
      <div class="cbody"><h4>${esc(c.name)}</h4><p>${esc(c.role||'Character')}</p></div>
    </div>
  `).join('')+`<div class="add-card" onclick="openCharModal()"><div class="plus">+</div><div style="font-size:12px;font-family:'DM Mono',monospace;">New Character</div></div>`;
}
function openCharModal(){
  MS.color='#c8822a';
  openModal('New Character',`
    <div class="fg"><div class="fl">Name</div><input class="fi" id="m-n" placeholder="Character nameâ€¦"></div>
    <div class="fg"><div class="fl">Role</div><input class="fi" id="m-r" placeholder="Hero, Villain, Mentorâ€¦"></div>
    <div class="fl">Color</div>
    <div class="crow">${PAL.map((c,i)=>`<div class="co ${i===0?'sel':''}" style="background:${c}" onclick="selCol(this,'${c}')"></div>`).join('')}</div>
  `,()=>{
    const name=document.getElementById('m-n').value.trim();if(!name)return;
    const c={id:'c'+Date.now(),name,role:document.getElementById('m-r').value,color:MS.color,image:null,appearance:'',personality:'',backstory:'',motivation:'',conflict:'',notes:''};
    S.chars.push(c);nav('char-detail',c.id);sched();
  });
}
function renderCharDet(id){
  const c=S.chars.find(x=>x.id===id);if(!c)return;
  document.getElementById('tt').textContent=c.name;
  document.getElementById('ts').textContent=c.role||'Character';
  document.getElementById('char-det').innerHTML=`
    <div style="display:flex;gap:18px;flex-wrap:wrap;margin-bottom:6px;">
      <div style="flex:0 0 170px;">
        <div class="imu ${c.image?'has':''}" onclick="trigImg('ci-${c.id}')">
          ${c.image?`<img src="${c.image}">`:`<div style="font-size:36px;opacity:0.2;">â—‰</div><p>Upload portrait</p>`}
          ${c.image?`<button class="img-del" onclick="event.stopPropagation();delCharImg('${c.id}')" title="Remove image">Ã—</button>`:''}
        </div>
        <input type="file" id="ci-${c.id}" accept="image/*" style="display:none" onchange="loadCImg('${c.id}',this)">
      </div>
      <div style="flex:1;min-width:140px;">
        <div class="fg"><div class="fl">Name</div><input class="fi" value="${esc(c.name)}" oninput="updChar('${c.id}','name',this.value)"></div>
        <div class="fg"><div class="fl">Role</div><input class="fi" value="${esc(c.role||'')}" oninput="updChar('${c.id}','role',this.value)" placeholder="Hero, Tricksterâ€¦"></div>
        <div class="fg"><div class="fl">Appearance</div><textarea class="fi" rows="3" oninput="updChar('${c.id}','appearance',this.value)" placeholder="Physical descriptionâ€¦">${esc(c.appearance||'')}</textarea></div>
      </div>
    </div>
    <div class="fg"><div class="fl">Personality</div><textarea class="fi" rows="3" oninput="updChar('${c.id}','personality',this.value)" placeholder="How they speak and feelâ€¦">${esc(c.personality||'')}</textarea></div>
    <div class="fg"><div class="fl">Backstory</div><textarea class="fi" rows="4" oninput="updChar('${c.id}','backstory',this.value)" placeholder="Their historyâ€¦">${esc(c.backstory||'')}</textarea></div>
    <div class="fg"><div class="fl">Motivation</div><input class="fi" value="${esc(c.motivation||'')}" oninput="updChar('${c.id}','motivation',this.value)" placeholder="What do they want most?"></div>
    <div class="fg"><div class="fl">Conflict</div><textarea class="fi" rows="3" oninput="updChar('${c.id}','conflict',this.value)" placeholder="What stands in their way?">${esc(c.conflict||'')}</textarea></div>
    <div class="fg"><div class="fl">Notes</div><textarea class="fi" rows="3" oninput="updChar('${c.id}','notes',this.value)" placeholder="Plot notes, arcsâ€¦">${esc(c.notes||'')}</textarea></div>
    <div style="padding-top:12px;border-top:1px solid var(--border);display:flex;gap:8px;">
      <button onclick="nav('characters')" style="background:none;border:1px solid var(--border);color:var(--text2);padding:6px 13px;border-radius:6px;cursor:pointer;font-size:14px;">â† Back</button>
      <button onclick="delChar('${c.id}')" style="background:none;border:1px solid var(--red);color:var(--red);padding:6px 13px;border-radius:6px;cursor:pointer;font-size:14px;">Delete</button>
    </div>`;
}
function trigImg(id){document.getElementById(id).click();}
function loadCImg(id,inp){const f=inp.files[0];if(!f)return;const r=new FileReader();r.onload=e=>{const c=S.chars.find(x=>x.id===id);if(c){c.image=e.target.result;renderCharDet(id);sched();}};r.readAsDataURL(f);}
function delCharImg(id){const c=S.chars.find(x=>x.id===id);if(c){c.image=null;renderCharDet(id);sched();}}
function updChar(id,k,v){const c=S.chars.find(x=>x.id===id);if(c){c[k]=v;if(k==='name')document.getElementById('tt').textContent=v;if(k==='role')document.getElementById('ts').textContent=v||'Character';sched();}}
function delChar(id){if(!confirm('Delete?'))return;S.chars=S.chars.filter(x=>x.id!==id);nav('characters');sched();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOCATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderLocDet(id){
  const l=S.locs.find(x=>x.id===id);if(!l)return;
  document.getElementById('tt').textContent=l.name;
  document.getElementById('ts').textContent='Location';
  document.getElementById('loc-det').innerHTML=`
    <div style="height:3px;background:${WCOL.locations};margin:-22px -24px 18px;"></div>
    <div style="display:flex;gap:16px;flex-wrap:wrap;margin-bottom:6px;">
      <div style="flex:0 0 160px;">
        <div class="imu ${l.image?'has':''}" onclick="trigImg('wi-${l.id}')">
          ${l.image?`<img src="${l.image}">`:`<div style="font-size:32px;opacity:0.2;">âŒ–</div><p>Upload image</p>`}
          ${l.image?`<button class="img-del" onclick="event.stopPropagation();delWImg('locations','${l.id}')" title="Remove image">Ã—</button>`:''}
        </div>
        <input type="file" id="wi-${l.id}" accept="image/*" style="display:none" onchange="loadWImg('locations','${l.id}',this)">
      </div>
      <div style="flex:1;min-width:130px;">
        <div class="fg"><div class="fl">Name</div><input class="fi" value="${esc(l.name)}" oninput="updW('locations','${l.id}','name',this.value)"></div>
        <div class="fg"><div class="fl">Type</div><input class="fi" value="${esc(l.type||'')}" oninput="updW('locations','${l.id}','type',this.value)" placeholder="City, Forestâ€¦"></div>
      </div>
    </div>
    ${WFLDS.locations.map(([k,lb,m])=>`<div class="fg"><div class="fl">${lb}</div>${m?`<textarea class="fi" rows="3" oninput="updW('locations','${l.id}','${k}',this.value)" placeholder="${lb}â€¦">${esc(l[k]||'')}</textarea>`:`<input class="fi" value="${esc(l[k]||'')}" oninput="updW('locations','${l.id}','${k}',this.value)" placeholder="${lb}â€¦">`}</div>`).join('')}
    <div style="padding-top:12px;border-top:1px solid var(--border);display:flex;gap:8px;">
      <button onclick="nav('locations')" style="background:none;border:1px solid var(--border);color:var(--text2);padding:6px 13px;border-radius:6px;cursor:pointer;font-size:14px;">â† Back</button>
      <button onclick="delW('locations','${l.id}')" style="background:none;border:1px solid var(--red);color:var(--red);padding:6px 13px;border-radius:6px;cursor:pointer;font-size:14px;">Delete</button>
    </div>`;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAPS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderMaps(){
  const dz=document.getElementById('dz');
  if(!dz._set){
    dz.addEventListener('dragover',e=>{e.preventDefault();dz.classList.add('dov');});
    dz.addEventListener('dragleave',()=>dz.classList.remove('dov'));
    dz.addEventListener('drop',e=>{e.preventDefault();dz.classList.remove('dov');handleUp(e.dataTransfer.files);});
    dz._set=true;
  }
  document.getElementById('maps-grid').innerHTML=S.maps.map(m=>`
    <div class="map-card" onclick="openLB('${m.id}')">
      <button class="map-del" onclick="event.stopPropagation();delMap('${m.id}')" title="Delete">Ã—</button>
      <div class="miw">${m.data?`<img src="${m.data}" alt="${esc(m.name)}">`:`<div class="mph">ğŸ—º</div>`}</div>
      <div class="mbody"><h4>${esc(m.name)}</h4><p>${esc(m.date)}</p></div>
    </div>
  `).join('');
}
function handleUp(files){
  Array.from(files).filter(f=>f.type.startsWith('image/')).forEach(f=>{
    const r=new FileReader();
    r.onload=e=>{S.maps.push({id:'m'+Date.now()+Math.random(),name:f.name.replace(/\.[^.]+$/,''),data:e.target.result,date:today()});renderMaps();sched();};
    r.readAsDataURL(f);
  });
}
function openLB(id){const m=S.maps.find(x=>x.id===id);if(!m)return;document.getElementById('lb-img').src=m.data;document.getElementById('lb-cap').textContent=m.name;document.getElementById('lb').classList.add('on');}
function closeLB(){document.getElementById('lb').classList.remove('on');}
function delMap(id){if(!confirm('Delete this image?'))return;S.maps=S.maps.filter(x=>x.id!==id);renderMaps();sched();}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WIKI
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderWG(sec,gridId){
  const items=S[sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec]||[];
  const color=WCOL[sec]||'#c8822a';const icon=WICO[sec]||'â—';
  document.getElementById(gridId).innerHTML=items.map(item=>`
    <div class="wcard" onclick="nav('wiki-detail','${sec}:${item.id}')">
      <div class="wct" style="background:${color}"></div>
      <div class="wcb"><div class="wci">${icon}</div><h4>${esc(item.name)}</h4><p>${esc((item.overview||item.description||item.notes||'').substring(0,75))}â€¦</p></div>
    </div>
  `).join('')+`<div class="add-card" onclick="openWM('${sec}')"><div class="plus">+</div><div style="font-size:11px;font-family:'DM Mono',monospace;">New Entry</div></div>`;
}
function renderWD(combined){
  const [sec,id]=combined.split(':');
  const arr=S[sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec]||[];
  const item=arr.find(x=>x.id===id);if(!item)return;
  const fields=WFLDS[sec]||[['notes','Notes',true]];
  const color=WCOL[sec]||'#c8822a';const icon=WICO[sec]||'â—';
  const hasImg=['locations','species','culture'].includes(sec);
  document.getElementById('tt').textContent=item.name;
  document.getElementById('ts').textContent=sec.charAt(0).toUpperCase()+sec.slice(1);
  document.getElementById('wiki-det').innerHTML=`
    <div style="height:3px;background:${color};margin:-22px -24px 18px;"></div>
    ${hasImg?`
      <div style="display:flex;gap:16px;flex-wrap:wrap;margin-bottom:6px;">
        <div style="flex:0 0 160px;">
          <div class="imu ${item.image?'has':''}" onclick="trigImg('wi-${id}')">
            ${item.image?`<img src="${item.image}">`:`<div style="font-size:30px;opacity:0.2;">${icon}</div><p>Upload image</p>`}
            ${item.image?`<button class="img-del" onclick="event.stopPropagation();delWImg('${sec}','${id}')" title="Remove image">Ã—</button>`:''}
          </div>
          <input type="file" id="wi-${id}" accept="image/*" style="display:none" onchange="loadWImg('${sec}','${id}',this)">
        </div>
        <div style="flex:1;min-width:130px;"><div class="fg"><div class="fl">Name</div><input class="fi" value="${esc(item.name)}" oninput="updW('${sec}','${id}','name',this.value)"></div></div>
      </div>
    `:`<div class="fg"><div class="fl">Name</div><input class="fi" value="${esc(item.name)}" oninput="updW('${sec}','${id}','name',this.value)"></div>`}
    ${fields.map(([k,lb,m])=>`<div class="fg"><div class="fl">${lb}</div>${m?`<textarea class="fi" rows="3" oninput="updW('${sec}','${id}','${k}',this.value)" placeholder="${lb}â€¦">${esc(item[k]||'')}</textarea>`:`<input class="fi" value="${esc(item[k]||'')}" oninput="updW('${sec}','${id}','${k}',this.value)" placeholder="${lb}â€¦">`}</div>`).join('')}
    <div style="padding-top:12px;border-top:1px solid var(--border);display:flex;gap:8px;">
      <button onclick="nav('${sec}')" style="background:none;border:1px solid var(--border);color:var(--text2);padding:6px 13px;border-radius:6px;cursor:pointer;font-size:14px;">â† Back</button>
      <button onclick="delW('${sec}','${id}')" style="background:none;border:1px solid var(--red);color:var(--red);padding:6px 13px;border-radius:6px;cursor:pointer;font-size:14px;">Delete</button>
    </div>`;
}
function loadWImg(sec,id,inp){
  const f=inp.files[0];if(!f)return;
  const r=new FileReader();
  r.onload=e=>{
    const arr=S[sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec]||[];
    const item=arr.find(x=>x.id===id);
    if(item){item.image=e.target.result;if(sec==='locations')renderLocDet(id);else renderWD(sec+':'+id);sched();}
  };r.readAsDataURL(f);
}
function delWImg(sec,id){
  const arr=S[sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec]||[];
  const item=arr.find(x=>x.id===id);
  if(item){item.image=null;if(sec==='locations')renderLocDet(id);else renderWD(sec+':'+id);sched();}
}
function updW(sec,id,k,v){
  const arr=S[sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec]||[];
  const item=arr.find(x=>x.id===id);if(item){item[k]=v;if(k==='name')document.getElementById('tt').textContent=v;sched();}
}
function delW(sec,id){
  if(!confirm('Delete?'))return;
  const key=sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec;
  S[key]=S[key].filter(x=>x.id!==id);nav(sec);sched();
}
function openWM(sec){
  const label=sec.charAt(0).toUpperCase()+sec.slice(1).replace(/s$/,' Entry');
  openModal('New '+label,`
    <div class="fg"><div class="fl">Name</div><input class="fi" id="m-n" placeholder="Nameâ€¦"></div>
    <div class="fg"><div class="fl">Brief Description</div><textarea class="fi" id="m-ov" rows="3" placeholder="Short overviewâ€¦"></textarea></div>
  `,()=>{
    const name=document.getElementById('m-n').value.trim();if(!name)return;
    const key=sec==='locations'?'locs':sec==='encyclopedia'?'enc':sec==='research'?'res':sec;
    if(!S[key])S[key]=[];
    const item={id:'w'+Date.now(),name,overview:document.getElementById('m-ov').value,notes:''};
    S[key].push(item);sched();
    if(sec==='locations')nav('loc-detail',item.id);else nav('wiki-detail',sec+':'+item.id);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(title,body,cb){
  document.getElementById('modal-title').textContent=title;
  document.getElementById('modal-body').innerHTML=body;
  document.getElementById('modal').classList.add('on');
  MS.cb=cb;
  setTimeout(()=>document.querySelector('#modal-body input,#modal-body textarea')?.focus(),60);
}
function closeModal(){document.getElementById('modal').classList.remove('on');MS.cb=null;}
function modalOK(){if(MS.cb)MS.cb();closeModal();}
function selCol(el,c){document.querySelectorAll('.co').forEach(o=>o.classList.remove('sel'));el.classList.add('sel');MS.color=c;}

function esc(s){return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KEYBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('keydown',e=>{
  if(e.key==='Escape'){closeModal();closeLB();}
  if((e.metaKey||e.ctrlKey)&&e.key==='\\'){e.preventDefault();toggleSB();}
});
document.getElementById('modal-body').addEventListener('keydown',e=>{
  if(e.key==='Enter'&&e.target.tagName!=='TEXTAREA'){e.preventDefault();modalOK();}
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SERVICE WORKER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('./sw.js').catch(()=>{});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
renderLib();
</script>
</body>
</html>
